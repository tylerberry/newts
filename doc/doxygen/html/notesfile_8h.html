<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libnewtsclient: notesfile.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>notesfile.h File Reference</h1><code>#include &quot;newts/config.h&quot;</code><br>
<code>#include &quot;<a class="el" href="nfref_8h-source.html">newts/nfref.h</a>&quot;</code><br>

<p>
<a href="notesfile_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnotesfile.html">notesfile</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>opts</b></td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666eca">nf_statuses</a> { <br>
&nbsp;&nbsp;<a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666ecafda7c9db1eedb83ef505e104d9037f74">NF_ANONYMOUS</a> =  01, 
<a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666ecac83015e2cd25a99a8b1a808ca7955be5">NF_CONFIDENTIAL</a> =  02, 
<a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666ecac396b9118298dcf14250a5e1b3372a9d">NF_LOCKED</a> =  04, 
<a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666eca772e4d57e8e8c0956591e41abbab6b2d">NF_ARCHIVE</a> =  010, 
<br>
&nbsp;&nbsp;<a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666ecae6a0ebe6cd44268328bd973c2634e62a">NF_MODERATED</a> =  020, 
<a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666eca033a01f265f63bc11ee5d8ff4302bbd8">NF_POLICY</a> =  040
<br>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="notesfile_8h.html#ff88c2e91143dd3d9a5d6b79205870bc">close_nf</a> (struct <a class="el" href="structnotesfile.html">notesfile</a> *nf, int updatestats)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="notesfile_8h.html#6f79a3f0bc371ddc682535a06cee87f1">compress_nf</a> (struct <a class="el" href="structnotesfile.html">notesfile</a> *nf, unsigned *numnotes, unsigned *numresps)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2e3ce73dc8062737778e10bcbbd42d38"></a><!-- doxytag: member="notesfile.h::get_next_bug" ref="2e3ce73dc8062737778e10bcbbd42d38" args="(const struct notesfile *nf)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_next_bug</b> (const struct <a class="el" href="structnotesfile.html">notesfile</a> *nf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c197b1e47f633b90ea618f63b5c873f1"></a><!-- doxytag: member="notesfile.h::modify_nf" ref="c197b1e47f633b90ea618f63b5c873f1" args="(struct notesfile *nf)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>modify_nf</b> (struct <a class="el" href="structnotesfile.html">notesfile</a> *nf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct <a class="el" href="structnotesfile.html">notesfile</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="notesfile_8h.html#035810a80d1ccbb3270901873d47cc75">nf_alloc</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="notesfile_8h.html#3e7a85ca63164fa059e531ed265dd1ee">nf_free</a> (struct <a class="el" href="structnotesfile.html">notesfile</a> *nf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="99c5e5df37510a0da91e8bc3f3f1b11b"></a><!-- doxytag: member="notesfile.h::open_nf" ref="99c5e5df37510a0da91e8bc3f3f1b11b" args="(const struct nfref *ref, struct notesfile *nf)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>open_nf</b> (const struct <a class="el" href="structnfref.html">nfref</a> *ref, struct <a class="el" href="structnotesfile.html">notesfile</a> *nf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="notesfile_8h.html#b61f7fe44a0ffa3bac7e3cbf5ae74e59">update_nf</a> (struct <a class="el" href="structnotesfile.html">notesfile</a> *nf)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Notesfile datatype and related functions. <hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="592b40327dd94a5be49dbabb7d666eca"></a><!-- doxytag: member="notesfile.h::nf_statuses" ref="592b40327dd94a5be49dbabb7d666eca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="notesfile_8h.html#592b40327dd94a5be49dbabb7d666eca">nf_statuses</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Various flags a <a class="el" href="structnotesfile.html">notesfile</a> can have set. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="592b40327dd94a5be49dbabb7d666ecafda7c9db1eedb83ef505e104d9037f74"></a><!-- doxytag: member="NF_ANONYMOUS" ref="592b40327dd94a5be49dbabb7d666ecafda7c9db1eedb83ef505e104d9037f74" args="" -->NF_ANONYMOUS</em>&nbsp;</td><td>
Notesfile allows truly anonymous notes. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="592b40327dd94a5be49dbabb7d666ecac83015e2cd25a99a8b1a808ca7955be5"></a><!-- doxytag: member="NF_CONFIDENTIAL" ref="592b40327dd94a5be49dbabb7d666ecac83015e2cd25a99a8b1a808ca7955be5" args="" -->NF_CONFIDENTIAL</em>&nbsp;</td><td>
Notesfile allows authors to remain confidential. (Directors will still be able to see the <a class="el" href="structauthor.html">author</a> of a note. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="592b40327dd94a5be49dbabb7d666ecac396b9118298dcf14250a5e1b3372a9d"></a><!-- doxytag: member="NF_LOCKED" ref="592b40327dd94a5be49dbabb7d666ecac396b9118298dcf14250a5e1b3372a9d" args="" -->NF_LOCKED</em>&nbsp;</td><td>
Notesfile is locked for maintenance. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="592b40327dd94a5be49dbabb7d666eca772e4d57e8e8c0956591e41abbab6b2d"></a><!-- doxytag: member="NF_ARCHIVE" ref="592b40327dd94a5be49dbabb7d666eca772e4d57e8e8c0956591e41abbab6b2d" args="" -->NF_ARCHIVE</em>&nbsp;</td><td>
Notesfile is an archive. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="592b40327dd94a5be49dbabb7d666ecae6a0ebe6cd44268328bd973c2634e62a"></a><!-- doxytag: member="NF_MODERATED" ref="592b40327dd94a5be49dbabb7d666ecae6a0ebe6cd44268328bd973c2634e62a" args="" -->NF_MODERATED</em>&nbsp;</td><td>
New notes require a director's approval. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="592b40327dd94a5be49dbabb7d666eca033a01f265f63bc11ee5d8ff4302bbd8"></a><!-- doxytag: member="NF_POLICY" ref="592b40327dd94a5be49dbabb7d666eca033a01f265f63bc11ee5d8ff4302bbd8" args="" -->NF_POLICY</em>&nbsp;</td><td>
Notesfile has a policy note. </td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ff88c2e91143dd3d9a5d6b79205870bc"></a><!-- doxytag: member="notesfile.h::close_nf" ref="ff88c2e91143dd3d9a5d6b79205870bc" args="(struct notesfile *nf, int updatestats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int close_nf           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnotesfile.html">notesfile</a> *&nbsp;</td>
          <td class="paramname"> <em>nf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updatestats</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform whatever actions are necessary to finish using a <a class="el" href="structnotesfile.html">notesfile</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nf</em>&nbsp;</td><td>An open <a class="el" href="structnotesfile.html">notesfile</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>updatestats</em>&nbsp;</td><td>A flag controlling whether to update the notesfile's statistics; 0 means no, anything else means yes.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>FIXME</dd></dl>
<dl class="user" compact><dt><b>Side effects:</b></dt><dd>May invalidate further connections to this <a class="el" href="structnotesfile.html">notesfile</a> until it is reopened with open_nf. </dd></dl>

</div>
</div><p>
<a class="anchor" name="6f79a3f0bc371ddc682535a06cee87f1"></a><!-- doxytag: member="notesfile.h::compress_nf" ref="6f79a3f0bc371ddc682535a06cee87f1" args="(struct notesfile *nf, unsigned *numnotes, unsigned *numresps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compress_nf           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnotesfile.html">notesfile</a> *&nbsp;</td>
          <td class="paramname"> <em>nf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&nbsp;</td>
          <td class="paramname"> <em>numnotes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&nbsp;</td>
          <td class="paramname"> <em>numresps</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Commit note deletions and otherwise clean up unused <a class="el" href="structnotesfile.html">notesfile</a> data.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nf</em>&nbsp;</td><td>An open <a class="el" href="structnotesfile.html">notesfile</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numnotes</em>&nbsp;</td><td>A location to place the number of notes after compression. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numresps</em>&nbsp;</td><td>A location to place the number of responses after compression.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>FIXME</dd></dl>
<dl class="user" compact><dt><b>Side effects:</b></dt><dd><em>numnotes</em> and <em>numresps</em> will be updated to hold the number of notes and responses remaining in the <a class="el" href="structnotesfile.html">notesfile</a> after compression. On error, the value of these variables is undefined.</dd></dl>
<dl class="user" compact><dt><b></b></dt><dd><a class="el" href="notesfile_8h.html#b61f7fe44a0ffa3bac7e3cbf5ae74e59">update_nf</a> will automatically be called on <em>nf</em>. The <a class="el" href="structnotesfile.html">notesfile</a> will potentially be seriously different in structure; if you memoize anything about the <a class="el" href="structnotesfile.html">notesfile</a>, you should forget it after compression. </dd></dl>

</div>
</div><p>
<a class="anchor" name="035810a80d1ccbb3270901873d47cc75"></a><!-- doxytag: member="notesfile.h::nf_alloc" ref="035810a80d1ccbb3270901873d47cc75" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structnotesfile.html">notesfile</a>* nf_alloc           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a new struct <a class="el" href="structnotesfile.html">notesfile</a>.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A newly allocated struct <a class="el" href="structnotesfile.html">notesfile</a>. This should be freed with nf_free when no longer needed.</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="notesfile_8h.html#3e7a85ca63164fa059e531ed265dd1ee">nf_free</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="3e7a85ca63164fa059e531ed265dd1ee"></a><!-- doxytag: member="notesfile.h::nf_free" ref="3e7a85ca63164fa059e531ed265dd1ee" args="(struct notesfile *nf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nf_free           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnotesfile.html">notesfile</a> *&nbsp;</td>
          <td class="paramname"> <em>nf</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Deallocate <em>nf</em>.<p>
<dl class="user" compact><dt><b>Side effects:</b></dt><dd><em>nf</em> will be invalidated, and should no longer be used.</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="notesfile_8h.html#035810a80d1ccbb3270901873d47cc75">nf_alloc</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="b61f7fe44a0ffa3bac7e3cbf5ae74e59"></a><!-- doxytag: member="notesfile.h::update_nf" ref="b61f7fe44a0ffa3bac7e3cbf5ae74e59" args="(struct notesfile *nf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_nf           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnotesfile.html">notesfile</a> *&nbsp;</td>
          <td class="paramname"> <em>nf</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Refresh the metadata for an already opened <a class="el" href="structnotesfile.html">notesfile</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nf</em>&nbsp;</td><td>An open <a class="el" href="structnotesfile.html">notesfile</a>.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>FIXME</dd></dl>
<dl class="user" compact><dt><b>Side effects:</b></dt><dd>The values stored in <em>nf</em> will be modified. </dd></dl>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Dec 30 13:30:20 2007 for libnewtsclient by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
